module DeepSecurity

  class AntiMalwareEvent < TransportObject

    # Represents an Anti-Malware event

    attr_integer_accessor :anti_malware_config_id
    attr_integer_accessor :anti_malware_event_id
    attr_datetime_accessor :end_time
    attr_integer_accessor :error_code, :host_id
    attr_string_accessor :infected_file_path
    attr_string_accessor :infection_source
    attr_datetime_accessor :log_date
    attr_string_accessor :malware_name
    attr_enum_accessor :malware_type, EnumMalwareType
    attr_integer_accessor :protocol
    attr_integer_accessor :quarantine_record_idattr_integer_accessor
    attr_integer_accessor :scan_result_action1
    attr_integer_accessor :scan_result_action2
    attr_enum_accessor :scan_type, EnumAntiMalwareScanType
    array_object_accessor :spyware_items, AntiMalwareSpywareItem
    attr_datetime_accessor :start_time
    attr_string_accessor :tags
    attr_integer_accessor :scan_action1
    attr_integer_accessor :scan_action2
    attr_string_accessor :summary_scan_result

    # cache_by_aspect :id, :name


  end

  class Manager

    # Retrieves the AntiMalware events specified by the time and host filter.
    # public AntiMalwareEventListTransport antiMalwareEventRetrieve(
    #   TimeFilterTransport timeFilter,
    #   HostFilterTransport hostFilter,
    #   IDFilterTransport eventIdFilter,
    #   String sID)
    def anti_malware_events(timeFilter, hostFilter, eventIdFilter)
      events = send_authenticated_request("anti_malware_event_retrieve", {
          :timeFilter => timeFilter.as_savon_data,
          :hostFilter => hostFilter.as_savon_data,
          :eventIdFilter => eventIdFilter.as_savon_data})[:anti_malware_events]
      return [] if events.nil?
      events[:item].map do |each|
        AntiMalwareEvent.from_savon_data(self, each)
      end
    end

  end

end
